var urls=new Array("http://twitter.com","http://tweetmeme.com");var timer=0;setInterval(function(){timer++},1000);var popup=function(){};var Cookie={create:function(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString()}else{var expires=""}document.cookie=name+"="+value+expires+"; path=/; domain=tweetmeme.com"},erase:function(name){this.create(name,"",-1)},read:function(name){var nameEQ=name+"=";var ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(nameEQ)==0){return c.substring(nameEQ.length,c.length)}}return null}};var tweet=document.getElementsByTagName("div")[1];var a=document.getElementsByTagName("a");var span=document.getElementsByTagName("span");var settings=getSettings();var user=(Cookie.read("user")!=null&&Cookie.read("user_token")!=null)?true:false;if(span[0].innerHTML!="?"){beenTweeted();if(!settings){var url="http://tweetmeme.com/ajax/partial?body=option&external=true";url+="&url="+tweet.id.substr(1);url+="&source="+document.getElementById("source").value;url+="&service="+document.getElementById("service").value;url+="&service_api="+document.getElementById("service_api").value;url+="&alias="+encodeURIComponent(document.getElementById("alias").value);createPopup(url,450,350,"Enable Logged in Retweeting")}else{if(settings["tweetoption"]=="yes"){if(user){if(settings["popup"]!="no"){var url="http://tweetmeme.com/ajax/partial?body=tweet&external=true";url+="&id="+tweet.id.substr(1);url+="&source="+document.getElementById("source").value;url+="&service="+document.getElementById("service").value;url+="&service_api="+document.getElementById("service_api").value;url+="&alias="+encodeURIComponent(document.getElementById("alias").value);createPopup(url,450,225,"Retweet")}else{var clickfunction=function(e){e=e||window.event;if(e&&e.preventDefault){e.preventDefault()}else{window.event.returnValue=false}sendrequest(tweet.id)};a[1].onclick=clickfunction}}else{var url="http://tweetmeme.com/auth/login?autotweet=1&r=";url+=escape("/ajax/partial?body=option&external=true&url="+tweet.id.substr(1)+"&source="+document.getElementById("source").value);createPopup(url,800,400,"Log into Twitter")}}}var tweetedcheck=function(){if(!beenTweeted()){setTimeout(tweetedcheck,1000)}else{if(timer>1){var celement=document.getElementsByTagName("span")[0];celement.innerHTML=parseInt(celement.innerHTML)+1}}};setTimeout(tweetedcheck,1000);addEvent(a[1],"mousedown",tracking)}function getSettings(){if(Cookie.read("user_settings")!=null){var args=decodeURIComponent(Cookie.read("user_settings"));var args=args.split("&");var s=new Object;for(var i=0;i<args.length;i++){var dum=args[i].split("=");s[dum[0]]=dum[1]}return s}else{return false}}function createPopup(url,x,y,title){popup=function(){var top=(window.screen.height/2)-(y/2);var left=(window.screen.width/2)-(x/2);window.open(url,"","menubar=0,resizable=1,status=1,toolbar=0,location=0,width="+x+",height="+y+",top="+top+",left="+left)};a[1].target="";var old_href=a[1].href;a[1].href="JavaScript: popup();";addEvent(a[1],"mouseover",function(){window.status=old_href})}function disable(){a[1].className="retweet selected";a[1].innerHTML="tweeted";var clickfunction=function(e){e=e||window.event;if(e&&e.preventDefault){e.preventDefault()}else{window.event.returnValue=false}};a[1].onclick=clickfunction}function beenTweeted(){var data=read();for(var i=0;i<data.length;i++){if(data[i]==tweet.id.substr(1)){disable();return true}}return false}function read(){var data=Cookie.read("tweetmeme_tweeted");if(data!=null){return data.split("-")}else{return new Array()}}function save(id){var data=read();data.push(id);Cookie.create("tweetmeme_tweeted",data.join("-"),7)}function check(linkarray){var match="";for(var i=0;i<linkarray.length;i++){var link=document.createElement("a");link.href=linkarray[i];document.body.appendChild(link);if(document.defaultView!=undefined){var color=document.defaultView.getComputedStyle(link,"").getPropertyValue("color")}else{var color=link.currentStyle["color"]}if(color=="rgb(0, 0, 0)"||color=="#000000"){match!=""?match+=","+escape(linkarray[i]):match=escape(linkarray[i])}}return match}function addEvent(a,action,func){if(a.addEventListener){a.addEventListener(action,func,false)}else{if(a.attachEvent){a.attachEvent("on"+action,func)}}}function tweetwindow(id){}var xmlhttp;function sendrequest(id){xmlhttp=null;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}}if(xmlhttp!=null){xmlhttp.onreadystatechange=response;xmlhttp.open("POST","/ajax/tweet",true);tweet.className+=" loading";var source=document.getElementById("source").value;var service=document.getElementById("service").value;var service_api=document.getElementById("service_api").value;var alias=document.getElementById("alias").value;var links=check(urls);var params="method=tweet&id="+id.substr(1)+"&source="+source+"&service="+service+"&service_api="+service_api+"&alias="+alias+"&timing="+timer;if(links!=""){params+="&visited="+links}xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.setRequestHeader("Content-length",params.length);xmlhttp.setRequestHeader("Connection","close");xmlhttp.send(params)}}function response(){if(xmlhttp.readyState==4){if(xmlhttp.status==200){var data=eval("("+xmlhttp.responseText+")");tweet.className="tweetmemebutton";if(data.response!="failure"){var celement=document.getElementsByTagName("span")[0];celement.innerHTML=parseInt(celement.innerHTML)+1;disable();save(tweet.id.substr(1))}else{if(data.data=="Already tweeted."){disable();save(tweet.id.substr(1))}else{}}}else{}}}function tracking(){if(settings["tweetoption"]=="no"){xmlhttp=null;if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest()}else{if(window.ActiveXObject){xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}}if(xmlhttp!=null){var url=document.getElementById("url").value;var links=check(urls);var params="url="+escape(url)+"&timing="+timer;if(links!=""){params+="&visited="+links}xmlhttp.open("GET","/track?"+params,true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.setRequestHeader("Connection","close");xmlhttp.send(params)}}};